# 经典的Linux内核学习方法论

[TOC]



对于学习来说，无论是在学校的课堂学习，还是这里说的内核学习，效果好或者坏，最主要取决于两个方面——方法论和心理。注意，我无视了智商的差异，这玩意儿玄之又玄，岔开了说，属于迷信的范畴。

前面又是Kernel地图，又是如何入手，说的都是方法论的问题，那么这里要面对的就主要是心理上的问题。

而心理上的问题主要有两个，一个是盲目，就是在能够熟练适用Linux之前，对Linux为何物还说不出个道道来，就迫不及待的盲目的去研究内核的源代码。这一部分人会觉得既然是学习内核，那么耗费时间在熟悉Linux的基本操作上纯粹是浪费宝贵的时间和感情。不过这样明显走入了一种心理误区。重述Linus的那句话：要先会使用它。

第二个就是恐惧。人类进化这么多年，面对复杂的物体和事情还是总会有天生的惧怕感，体现在内核学习上面就是：那么庞大复杂的内核代码，让人面对起来该情何以堪啊!

有了这种恐惧无力感存在，心理上就会去排斥面对接触内核源码，宁愿去抱着情景分析，搜集各种各样五花八门的内核书籍放在那里屯着，看了又忘，忘了又看，也不大情愿去认真细致得浏览源码。

有必要再强调一次，学习内核，就是学习内核的源代码，任何内核有关的书籍都是基于内核，而又不高于内核的。内核源码本身就是最好的参考资料，其他任何经典或非经典的书最多只是起到个辅助作用，不能也不应该取代内核代码在我们学习过程中的主导地位。

其实，只有在以内核源码为中心，坚持各种学习资源的长期建设不动摇，才能达到一定的高度，俯视Linux内核世界里的人生百态。

注意，这个观点与前面所说的学习效果主要取决于方法论和心理两个方面并不矛盾，它们属于不同层次上的问题。



## 内核文档

内核代码中包含有大量的文档，这些文档对于学习理解内核有着不可估量的价值，记住，在任何时候，它们在我们心目中的地位都应该高于那些各式的内核参考书。下面是一些内核新人所应该阅读的文档。

这个文件首先简单介绍了Linux内核的背景，然后描述了如何配置和编译内核，最后还告诉我们出现问题时应该怎么办。

Documentation/Changes这个文件给出了用来编译和使用内核所需要的最小软件包列表。

Documentation/CodingStyle这个文件描述了内核首选的编码风格，所有代码都应该遵守里面定义的规范。

Documentation/SubmittingPatches

Documentation/SubmittingDrivers

Documentation/SubmitChecklist



这三个文件都是描述如何提交代码的，其中SubmittingPatches给出创建和提交补丁的过程，

SubmittingDrivers描述了如何将 设备驱动提交给2.4、2.6等不同版本的内核树，SubmitChecklist则描述了提交代码之前需要check自己的代码应该遵守的某些事项。

Documentation/stable_api_nonsense.txt这个文件解释了为什么内核没有一个稳定的内部API(到用户空间的接口 ——系统调用——是稳定的)，它对于理解Linux的开发哲学至关重要，对于将开发平台从其他操作系统转移到Linux的开发者来说也很重要。

Documentation/stable_kernel_rules.txt解释了稳定版内核(stable releases)发布的规则，以及如何将补丁提交给这些版本。

内核开发者对安全性问题非常关注，如果你认为自己发现了这样的问题，可以根据这个文件中给出的联系方式提交bug，以便能够尽可能快的解决这个问题。

Documentation/kernel-docs.txt这个文件列举了很多内核相关的文档和书籍，里面不乏经典之作。

Documentation/applying-patches.txt这个文件回答了如何为内核打补叮

Documentation/bug-hunting这个文件是有关寻找、提交、修正bug的。

Documentation/HOWTO这个文件将指导你如何成为一名内核开发者，并且学会如何同内核开发社区合作。它尽可能不包括任何关于内核编程的技术细节，但会给你指引一条获得这些知识的正确途径。

待到山花烂漫时，还是那些经典在微笑。



## Linux 内核书籍

有关内核的书籍可以用汗牛充栋来形容，不过只有一些经典的神作经住了考验。首先是5本久经考验的神作(个人概括为“2+1+2”，第一个2是指2本全面讲 解内核的书，中间的1指1本讲解驱动开发的书，后面的2则指2本有关内核具体子系统的书，你是否想到了某某广告里三个人突然站起单臂齐举高呼“1比1 比 1”的场景?)。



### 《Linux内核设计与实现》

简称LKD，从入门开始，介绍了诸如进程管理、系统调用、中断和中断处理程序、内核同步、时

间管理、内存管理、地址空间、调试技术等方面，内容比较浅显易懂，个人认为是内核新人首先必

读的书籍。新人得有此书，足矣!



### 《深入理解Linux内核》

简称ULK，相比于LKD的内容不够深入、覆盖面不广，ULK要深入全面得多。

前面这两本，一本提纲挈领，一本全面深入。



### 《Linux设备驱动程序》

简称LDD，驱动开发者都要人手一本了。



### 《深入理解Linux虚拟内存管理》

简称LVMM，是一本介绍Linux虚拟内存管理机制的书。如果你希望深入的研究Linux的内存管理

子系统，仔细的研读这本书无疑是最好的选择。



### 《深入理解LINUX网络内幕》

一本讲解网络子系统实现的书，通过这本书，我们可以了解到Linux内核是如何实现复杂的网络功能的。(忘了声明下，我这列出来的书名是中文的，但是并不代表我建议大家去看他们的中文版，其中有的翻译的实在太??了，呵呵)

这5本书各有侧重，正如下面的图所展示的那样，恰好代表了个人一直主张的内核学习方法：首先通过LKD或ULK了解内核的设计实现特点，对内核有个整体全局的认识和理解，然后可分为两个岔路，如果从事驱动开发，则钻研LDD，如果希望对内核不是泛泛而谈而是有更深入的理解，则可以选择一个自己感兴趣的子系统，仔细分析它的代码，不懂的地方就通过社区、邮件列表或者直接发Email给maintainer请教等途径弄懂，切勿得过且过，这样分析下来，对同步、中断等等内核的很多机制也同样会非常了解，俗话说的一通则百通就是这个道理。当然，如果你选择研究的是内存管理或者网络，则可以有上面的两本书可以学习，如果是其他子系统可能就没有这么好的运气了。



## 内核社区

最近几年，社区网站非常的热火，不过此社区非彼社区。

Linux最大的一个优势就是它有一个紧密团结了众多使用者和开发者的社区，它的目标就是提供尽善尽美的内核。内核社区的中心是内核邮件列表(Linux Kernel Mailing List，LKML)，我们可以在http://vger.kernel.org/vger-lists.html#linux-kernel上面看到订阅这个邮件列表的细节。

内核邮件列表的流量很大，每天都有几百条消息，这里是大牛们的战场，小牛们的天堂，任何一个内核开发者都可以从中受益非浅。除了LKML，大多数子系统也有自己独立的邮件列表来协调各自的开发工作，比如USB子系统的邮件列表可以在http://www.linux-usb.org/mailing.html上面订阅。



## 其他网络资源

除了内核邮件列表，还有很多其他的论坛或网站值得我们经常关注。我们要知道，网络上不仅有兽兽和凤姐，也不仅有犀利哥和韩局长。http://www.kernel.org/ 可以通过这个网站上下载内核的源代码和补丁、跟踪内核bug等。http://kerneltrap.org Linux和BSD内核的技术新闻。如果没时间跟踪LKML，那么经常浏览kerneltrap是个好主意。http://lwn.net/ Linux weekly news，创建于1997年底的一个Linux新闻站点。http://zh-kernel.org/mailman/listinfo/linux-kernel 这是内核开发的中文邮件列表，里面活跃着很多内核开发领域的华人，比如Herbert Xu,、Mingming Cao、Bryan Wu等。
# External Network Identification

[TOC]



Once the tester's identity is protected, identifying the devices on the internet- accessible portion of the network is the next critical first step in scanning a network.

Attackers and penetration testers use this information to do the following:

- Identify devices that may confuse (load balancers) or eliminate (firewalls and packet inspection devices) test results
- Identify devices with known vulnerabilities
- Identify the requirement for continuing to implement stealthy scans
- Gain an understanding of the target's focus on secure architecture and on security in general



## Traceroute

Using the **Time To Live** (**TTL**) field in an IP packet, each hop from one point to the next elicits an ICMPTIME_EXCEEDED message from the receiving router, decrementing the value in the TTL field by 1. The packets count the number of hops and the route taken.

> :bulb: 
>
> Using a web-based *traceroute* (**www.traceroute.org**), it is possible to trace various geographic origin sites to the target network. These types of scans will **frequently identify more than one different network** connecting to the target, which is information that could be missed by conducting only a single `traceroute` command from a location close to the target. Web-based `traceroute` may also **identify multi-homed hosts** that connect two or more networks together. These hosts are an important target for attackers, because they drastically increase the attack surface leading to the target.

> In Kali, `traceroute` is a command-line program that uses ICMP packets to map the route; in Windows, the program is `tracert`.

### Load balancers

Sometimes using different host traceroute same target host may yeild different printing:  hops filtered (data is shown as * * *) path or complete path. This might indicate that load balancers are in effect.

You can confirm this using Kali's `lbd`script; however, this activity may be logged by the target site.

### Other route tracing tools

| Application | Description                                                  |
| ----------- | ------------------------------------------------------------ |
| hping3      | This is a TCP/IP packet assembler and analyzer. This supports TCP, UDP, ICMP, and raw-IP and uses a ping-like interface. |
| intrace     | This enables users to enumerate IP hops by exploiting existing TCP connections, both initiated from the local system or network or from local hosts. This makes it very useful for bypassing external filters such as firewalls. intrace is a replacement for the less reliable 0trace program. |
| trace6      | This is a traceroute program that uses ICMP6.                |

## ldb



## miranda.py



## nmap



## Shodan



## censys.io



## Mapping beyond the firewall

Penetration testers can utilize `fragroute` and `wafw00f` to identify whether there are any detection or prevention mechanisms put in place such as **Intrusion Detection System** (**IDS**) or an **Intrusion Prevention system** (**IPS**) or a **Web application Firewall** (**WAF**).



### fragroute



### wafw00f


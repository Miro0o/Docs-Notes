# Comprehensive Reconnaissance Applications

[TOC]



## Overview

### DNS reconnaissance and route mapping

DNS is a distributed database. 

DNS reconnaissance is concerned with identifying who owns a particular domain or series of IP addresses (the sort of information gained with whois although this has been completely changed with the **General Data Protection Regulation** (**GDPR**) enforcement across Europe from May 2018), the DNS information defining the actual domain names and IP addresses assigned to the target and the route between the penetration tester or the attacker and the final target.

This information gathering is semi-activeâ€”some of the information is available from freely available open sources such as www.DNSstuff.com, while other information is available from third parties such as DNS registrars. 

### whois

After 25th May 2018, there are no registrant details provided; however, attackers can understand which whois server responds and it retrieves domain data that includes availability, ownership, creation, expiration details, and name servers.

### Other basic CLI

1. nslookup
2. dig
3. 





## Deep Magic Information Gathering Tool (DMitry)

DMitry could perform whois lookups, retrieve netcraft.com information, search for sub-domains and email addresses, and perform TCP scans. Unfortunately, it wasn't extensible beyond these functions.



## recon-ng

The recon-ng framework is an open source framework for conducting reconnaissance (passive and active). The framework is similar to **Metasploit** and **Social Engineer Toolkit** (**SET**); recon-ng uses a very modular framework. Each module is a customized command interpreter, preconfigured to perform a specific task.



## SPARTA

The following items are available in the configuration:

- tool: This is the unique identifier of the command-line tool, for example, `nmap`
- label: This is the text that appears on the context menu
- command: Normally this should be in non-interactive mode and the full command that you will run using a tool
- Services: These are the list of services that need to be run during the automatic run; for example, if you configure to run `nmap` and when port 80 is identified automatically run `nikto`
- Protocol: Either `TCP` or `UDP` are the services that the tool should run on



## IPv4

| Application                  | Description                                                  |
| ---------------------------- | ------------------------------------------------------------ |
| dnsenum,dnsmap, and dnsrecon | These are comprehensive DNS scannersâ€”DNS record enumeration (A, MX, TXT, SOA, wildcard, and so on), subdomain brute-force attacks, Google lookup, reverse lookup, zone transfer, and zone walking. dsnrecon is usually the first choiceâ€”it is highly reliable, results are well parsed, and data can be directly imported into the Metasploit framework. |
| dnstracer                    | This determines where a given DNS gets its information from, and follows the chain of DNS servers back to the servers that know the data. |
| dnswalk                      | This DNS debugger checks specified domains for internal consistency and accuracy. |
| fierce                       | This locates non-contiguous IP space and hostnames against specified domains by attempting zone transfers and then attempting brute-force attacks to gain DNS information. |

## IPv6

The increased size of the addressable address space presents some problems to penetration testers, particularly when using scanners that step through the available address space looking for live servers. However, some features of the IPv6 protocol have simplified discovery, especially the use of ICMPv6 to identify active link-local addresses.

Kali includes several tools developed to take advantage of IPv6 (most comprehensive scanners, such as `nmap`, now support IPv6), some of which are as follows; tools that are particular to IPv6 were largely derived from the **THC- IPv6 Attack Toolkit**.

The following table provides the list of tools that are utilized for reconnaissance of IPv6:

| Application       | Description                                                  |
| ----------------- | ------------------------------------------------------------ |
| dnsdict6          | Enumerates sub-domains to obtain IPv4 and IPv6 addresses (if present) using a brute force search based on a supplied dictionary file or its own internal list. |
| dnsrevenum6       | Performs reverse DNS enumeration given an IPv6 address.      |
| `covert_send6 `   | Sends the content of a file covertly to the target.          |
| `covert_send6d `  | Writes covertly received content to file.                    |
| denial6           | Performs various denial of service attacks on a target.      |
| `detect-new-ip6 ` | Detects new IPv6 addresses joining the local network.        |
| detect_sniffer6   | Tests whether systems on the local LAN are sniffing          |
| Exploit6          | Performs exploits of various CVE-known IPv6 vulnerabilities on the destination |
| fake_dhcps6       | Fake DHCPv6 server                                           |



ðŸ‘‰ Metasploit can also be utilized for IPv6 host discovery. The auxiliary/scanner/discovery/ipv6_multicast_ping module will discover all of the IPv6- enabled machines with the physical (MAC) address, 

ðŸ‘‰ THC IPv6 suite `atk6-alive6` will discover alive addresses in the same segment.



## Native MS Windows commands

### nslookup



### net



### arp



### route



### netstat



### nbtstat

### reg

### wmic

### for
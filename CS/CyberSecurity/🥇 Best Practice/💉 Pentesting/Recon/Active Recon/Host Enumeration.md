# Host Enumeration

[TOC]



Host enumeration is the process of gaining specific particulars regarding a defined host. It is not enough to know that a server or wireless access point is present; instead, we need to expand the attack surface by identifying open ports, the base operating system, services that are running, and supporting applications.

This is highly intrusive and, unless care is taken, the active reconnaissance will be detected and logged by the target organization.



## Live host discovery

The first step is to run network ping sweeps against a target address space and look for responses that indicate that a particular target is live and capable of responding. 

Historically, pinging is referred to as the use of **ICMP**; however, **TCP**, **UDP**, **ICMP**, and **ARP** traffic can also be used to identify live hosts.

### IPv6

#### alive6

#### detect-new- ip6



### Packet Crafters

#### fping

#### hping2

#### hping3

#### nping



### nmap



### dnmap



## Port Discovery

There are 65,535 ports each for both TCP and UDP on each system. Some ports are known to be associated with particular services (for instance, **TCP** 20 and 21 are the usual ports for the **File Transfer Protocol** (**FTP**) service). 

The first 1,024 are the well- known ports, and most defined services run over ports in this range; accepted services and ports are maintained by [IANA](http://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml).

### nmap



### netcat

While attackers utilize the proxying application and Tor network, it is also possible to write their own custom network port scanner. The following one-line command can be utilized during penetration testing to identify the list of open ports just by using netcat: `while read r; do nc -v -z $r 1-65535; done < iplist`



## Operating System Discovery

Determining the operating system of a remote system is conducted using two types of scans:

- **Active fingerprinting**: The attacker sends normal and malformed packets to the target and records its response pattern, referred to as the fingerprint. By comparing the fingerprint to a local database, the operating system can be determined.
- **Passive fingerprinting**: The attacker sniffs, or records and analyzes the packet stream to determine the characteristics of the packets.

### Active Fingerprinting

#### nmap



#### xprobe2



### Passive Fingerprinting

#### Wireshark(?)



## Service Discovery

The following are some of the several techniques used to determine active services:

- **Identify default ports and services**: If the remote system is identified as having a Microsoft operating system with port 80 open (the WWW service), an attacker may assume that a default installation of Microsoft IIS is installed. Additional testing will be used to verify this assumption (nmap). 
- **Banner grabbing**: This is done using tools such as amap, netcat, nmap, and Telnet.

- **Review default web pages**: Some applications install with default administration, error, or other pages. If attackers access these, they will provide guidance on installed applications that may be vulnerable to attack. In the following screenshot, the attacker can easily identify the version of Apache Tomcat that has been installed on the target system.
- **Review source code**: Poorly configured web-based applications may respond to certain HTTP requests such as HEAD or OPTIONS with a response that includes the web server software version, and, possibly, the base operating system or the scripting environment in use.



## Large-scale Scanning

### Masscan

The biggest advantage of Masscan is randomization of hosts, ports, speed, flexibility, and compatibility.



### ping sweep

1. nmap
2. fping
3. customized script



## SNMP Enumeration

There are two types of community strings utilized in all versions of SNMP: 

- **Public**: Community string is used for read-only access
- **Private**: Community string is used for both read and write access



### snmpwalk


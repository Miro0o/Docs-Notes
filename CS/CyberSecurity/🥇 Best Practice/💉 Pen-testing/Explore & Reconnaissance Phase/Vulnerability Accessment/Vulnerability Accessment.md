# Vulnerability Accessment

[TOC]



## Intro



### Contents in this chapter

- Using online and local vulnerability resources
- Vulnerability scanning with Nmap
- Lua scripting
- Writing your own Nmap script using **Nmap Scripting Engine** (**NSE**) Selecting and customizing multiple vulnerability scanners
- Installing Nexpose and Nessus Threat modeling in general





## Vulnerability nomenclature



## Threat modeling

Offensive threat modeling is a formal approach that combines the results of reconnaissance and research to develop an attack strategy. An attacker has to consider the available targets and identify the types of targets, listed as follows:

- **Primary targets**: These are the primary entry point targets to any organization and when compromised, they serve the objective of a penetration test
- **Secondary targets**: These targets may provide information (security controls, password and logging policies, and local and domain administrator names and passwords) to support an attack or allow access to a primary target
- **Tertiary targets**: These targets may be unrelated to the testing or attack objective, but are relatively easy to compromise and may provide information or a distraction from the actual attack

## Local and online vulnerability databases

Penetration testers and attackers must find the particular exploits that will compromise known and suspected vulnerabilities. 

:one: The first place to start the search is at vendor sites;most hardware and application vendors release information about vulnerabilities when they release patches and upgrades. 

:two: Other online sites that collect, analyze, and share information about vulnerabilities are as follows:

- The National Vulnerability Database, which consolidates all public vulnerability data released by the US Government, available at http://web.nvd.nist.gov/view/vuln/search
- Secunia, available at http://secunia.com/community/
- Packetstorm security, available at https://packetstormsecurity.com/ SecurityFocus, available at http://www.securityfocus.com/vulnerabilities
- The Exploit database maintained by Offensive Security, available at https://www.exploit-db.com/
- For some 0-day vulnerabilities, penetration testers can also keep an eye on https://0day.today/

:three: The Exploit database is also copied locally to Kali and it can be found in the `/usr/share/exploitdb` directory.

To search the local copy of exploitdb, open a Terminal window and enter `searchsploit` and the desired search term(s) in the command prompt.

> :bulb:
>
> The search script scans for each line in the CSV file from left to right, so the order of the search terms is important; a search for *Oracle 10g* will return several exploits, but *10g Oracle* will not return any. Also, the script is weirdly case sensitive; although you are instructed to use lowercase characters in the search term, a search for *vsFTPd* returns no hits, but *vs FTPd* returns more hits with a space between *vs* and *FTP*. More effective searches of the CSV file can be conducted using the *grep* command or a search tool such as *KWrite* *(**apt-get install kwrite**).*




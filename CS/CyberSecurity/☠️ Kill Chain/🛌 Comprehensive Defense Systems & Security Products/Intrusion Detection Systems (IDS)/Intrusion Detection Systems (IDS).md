# Intrusion Detection Systems (IDS)

[TOC]



## Res
【深入浅出计算机网络 - 7.8 防火墙访问控制与入侵检测系统】 https://www.bilibili.com/video/BV1Gr4y1u7oe/?share_source=copy_web&vd_source=7740584ebdab35221363fc24d1582d9d



## Intro
> 边界安全/内生安全，安全左移：改变传统的事后检测、修复的思路，试图在软件产品的开发、测试阶段就考虑到可能的安全威胁并作出防范。

![](../../../../../Assets/Pics/Screenshot%202023-12-04%20at%208.58.45AM.png)

### 🤔 Threats & Intrusion 
入侵（**Intrusion**）是指在非法或未经授权的情况下，试图存取或处理系统或网络中的信息，或破坏系统或网络正常运行，致使系统或网络的机密性、完整行和可用性受到破坏的故意行为

### IDS Overview & Concepts
- 入侵检测（**Intrusion Detection**）是对入侵行为的发觉。它通过计算机网络或计算机系统的关键点采集信息并进行分析，从中发现网络或系统中是否有违反安全策略的行为和被攻击的迹象。
- 入侵检测系统（**Intrusion Detection System**，简称**IDS**）是指实现入侵检测功能的软件和硬件的集合。

IDS存在与发展的必然性
- 网络攻击造成的破坏性和损失日益严重
- 网络安全威胁日益增长
- 单纯的防火墙无法防范复杂多变的攻击

IDS 作用：智能发现攻击，记录并发出报警信息，启动响应动作；
- 克服某些传统的防御机制的限制；
- 在“深度防御”的基础上成为安全框架的一部分；
- 在整个组织的网络中能够识别入侵或违反安全策略的行为，并能够做出回应

IDS 工作流程：
- 预防入侵
	- 非常重要的第一步；
	- 阻止某些不良企图，例如防火墙无法检查和控制的；
	- 但是攻击仍然发生：
		- 网络、操作系统和应用在设计和实现上的缺陷；
		- 隧道技术；
		- 来自网络内部的攻击。
- 检测入侵
	- 是否能够实时检测到剩余的攻击?
	- 监控各种恶意行为：
		- 网络流量;
		- 主机中的行为;
	- 实时分析大量的审计数据，来识别入侵或误用。
- 对入侵做出响应
	- 实时响应；
	- 识别入侵并做出响应；
	- 做出反应以减小入侵造成的影响，并尽快恢复服务。

IDS 功能
- 自动检测入侵行为；
- 监视网络流量（Network IDS)和主机(HostIDS)中的操作；
- 分析入侵行为：
	- 基于特征
	- 基于异常
- 按预定的规则做出响应：
	- 阻止指定的行为

![](../../../../../Assets/Pics/Screenshot%202023-04-01%20at%204.26.59%20PM.png)

入侵检测(Intrusion Detection)，指对系统的运行状态进行监视，发现各种攻击企图、攻击行为或者攻击结果，以保证系统资源的机密性、完整性和可用性。**进行入侵检测的软件与硬件的组合便是入侵检测系统（Intrusion Detection System，IDS）**
- **警报(Alert)**，当一个入侵正在发生或者试图发生时，IDS将发布一个警报信息通知系统管理员。如果控制台与IDS同在一台机器，警报信息将显示在监视器上，也可能伴随着声音提示，如果是远程控制台，那么警报将通过IDS内置方法（通常是加密的）、简单网络管理协议（Simple Network Management Protocol, SNMP)（通常不加密）、电子邮件（Electronic Mail, E-mail）、短信息服务（Short Message Service, SMS）、IM（即时通信）或者以上几种方法的混合方式传递给管理员。
- **异常（Anomoly）**，当有某个事件与一个已知攻击的信号相匹配时，多数IDS都会告警；一个基于异常的 IDS 会构造一个当时活动的主机或网络的大致轮廓，当有一个在这个轮廓以外的事件发生时，IDS 就会告警。
- **特征(Signature)**，IDS的核心是攻击特征（签名），它使IDS在（入侵）事件发生时触发警报。如果特征信息过短会经常触发 IDS，导致误报或错报，过长则会减慢IDS的工作速度。将 IDS 所支持的特征数视为 IDS 好坏的标准是评价 IDS 产品优劣的常见误区，例如有的厂商用一个特征涵盖许多攻击，而有些厂商则会将这些特征单独列出，特征数量的多少并不能决定威胁检测能力的高低。

### IDS Development History
![](../../../../../Assets/Pics/Pasted%20image%2020231201095507.png)

🔗 https://c4pr1c3.github.io/cuc-ns/chap0x09/main.html#95-实战入侵检测系统

### Why IDS?
#### Non-IDS Defaults
传统的信息安全方法采用严格的访问控制和数据加密策略来保护，但在复杂系统中，这些策略是不充分的，它们是系统安全不可缺的部分但不能完全保证系统的安全
- 安全是过程
- 不仅仅是人！不仅仅是设备！IDS是安全的一部分！

入侵入门很容易
- 入侵教程随处可见
- 各种工具唾手可得

单一防护产品的弱点
- 防御方法和防御策略的有限性
- 动态多变的网络环境
- 来自外部和内部的威胁

防火墙为例：
- 网络边界的设备，只能抵挡外部來的入侵行为
- 自身存在弱点，也可能被攻破
- 对某些攻击保护很弱
- 即使透过防火墙的保护，合法的使用者仍会非法地使用系统，甚至提升自己的权限
- 仅能拒绝非法的连接請求，但是对于入侵者的攻击行为仍一无所知

![](../../../../../Assets/Pics/Screenshot%202023-12-04%20at%209.04.01AM.png)
#### IDS Services
入侵检测可以识别入侵者，识别入侵行为，监视和检测已成功的安全突破，为对抗入侵及时提供重要信息，以阻止事件的发生和事态的扩大，具有如下作用：
1. 实时检测网络系统的非法行为，持续地监视、分析网络中所有的数据报文，发现并及时处理所捕获的数据报文；
2. 安全审计，通过对入侵检测系统记录的网络事件进行统计分析，发现其中的异常现象，为评估系统的安全状态提供相关证据；
3. 不占用被保护系统的任何资源，作为独立的网络设备，可以做到对黑客透明，本身的安全性较高；
4. 主机入侵检测系统运行于被保护系统之上，可以直接保护、恢复系统；

![](../../../../../Assets/Pics/Pasted%20image%2020231201095349.png)
<small>入侵检测系统的作用</small>

在安全体系中，入侵检测系统是通过数据和行为模式判断其风险水平的典型系统:
- 防火墙相当于第一道安全闸门，可以组织一类人群的进入，但无法阻止同一类人群中的破坏分子，也不能组织内部的破坏分子，也不能组织内部的破坏分子；
- 访问控制系统可以不让低级权限的人做越权工作，但无法保证拥有高级权限的人不做破坏行为，也无法保证低级权限的人通过非法行为获得高级权限。

入侵检测系统可以说是防火墙系统的合理补充和有力延伸，它的目的是为响应决策提供威胁证据，在不影响网络部署的前提下，实时、动态地检测来自内部和外部的各种攻击，及时、准确、全面的发现入侵。这可以有效覆盖到防火墙检测和保护的盲区，通过与防火墙协同联动，达到有效网络安全防护。

### ⭐ IDS Metrics
入侵检测系统主要从以下方面进行的评价：
- 可靠性，指系统的容错能力和可持续运行能力；
- 可用性，指系统开销大小，对网络性能影响的大小；
- 可测试，指系统能够通过模拟攻击进行检测测试；
- 适应性，指系统易于开发和扩展；
- 实时性，指系统能够及早发现入侵企图；
- 安全性，指系统可确保自身的安全；
- 准确性，指系统正确识别入侵行为的能力。

Porras等给出了评价入侵检测系统性能的三个因素
- 准确性（Accuracy）--误报率
- 处理性能（Performance）
- 完备性（Completeness）--漏报率
Debar等增加了两个性能评价测度
- 容错性（Fault Tolerance）：IDS自身防御攻击的能力
- 及时性（Timeliness）：数据源分析的速度

其中，**准确性主要通过误报率和漏报率进行评估**，误报率和漏报率是衡量入侵检测系统效率的两个重要指标。在我国，入侵检测系统的评价有国家标准：[《信息安全技术 网络入侵检测系统技术要求和测试评价方法 GB/T 20275-2013》](http://std.samr.gov.cn/gb/search/gbDetailed?id=71F772D8069AD3A7E05397BE0A0AB82A) 。

误报率（False Positive Rate ，FPR）的计算公式为:
```
FPR = FP / N
```

漏报率（False Negative Rate ，FNR)的计算公式为：
```
FNR = FN / N
```

其中，N 是警报总数，FP 是误报事件总数。FN 为漏报事件总数。最理想的入侵检测系统的评估结果是误报率 FPR=0 且漏报率 FNR=0，但实际上误报率和漏报率常常是成反比的。

![](../../../../../Assets/Pics/Screenshot%202023-04-01%20at%204.27.36%20PM.png)

### Issues Faced IDS
- 误警率高
	- IDS的虚警率和漏警率之和即为误警率，误警问题已成为制约其发展的关键技术问题。
- 缺少统一的构建方法学
	- IDS系统内缺少结构化的方法学，同时入侵检测系统的内部缺乏有效的信息共享和协同机制，限制了对攻击的检测能力。
- 自学习能力差
	- 添加IDS检测规则常依赖于手工方式且更新缓慢，限制了IDS的可用性。
- 自身易受攻击
	- IDS本身是存在漏洞的软件程序，它容易成为黑客攻击的目标，一旦黑客攻击成功，那它所管理的网络安全就不能得到保证



## IDS Taxonomy
### 1️⃣ 检测分析技术方法
![](../../../../../Assets/Pics/Screenshot%202023-04-01%20at%204.27.24%20PM.png)

异常检测：通过采集和统计来发现网络或系统中可能出现的异常行为，向管理员提出警告。
特征检测：通过对采集的信息按已知的知识进行分析，来发现正在发生和已经发生的入侵行为。

### 2️⃣ 按检测范围
◆ 基于主机
◆ 基于网络
◆ 基于网络节点

### 3️⃣ Future Types of IDS (入侵检测系统的发展趋势)
- 分布式入侵检测：异构和大型网络中，系统的复杂度大大增加，模型建立十分困难，需要分布式入侵检测架构。其关键技术是检测信息的协同处理与入侵攻击的全局信息的获取。
- 应用层入侵检测：许多入侵活动的含义只有在应用层才能理解。但传统方法很少涉及到应用层，使得一些应用系统内的入侵活动难以检测，所以需要开发应用层的入侵检测技术。
- 智能入侵检测：智能化的入侵检测技术，使系统能够自动学习新的入侵活动，完善系统模型，提高检测的效率和准确性。
- 综合性监测系统：与其他的网络安全技术相结合，形成综合的检测系统，解决传统方法检测对象单一、检测攻击形式简单的问题。



## IDS Models /Frameworks /Standardization
通用入侵检测模型（**Denning**模型），层次化入侵检测模型（**IDM**），管理式入侵检测模型（**SNMP-IDSM**）


### 📐 Common IDS Models
#### CIDF (Common Intrusion Detection Framework)

#### OPSEC (Open Platform for Security)



## IDS Key Technologies
### IDS Basic Technologies

### IDS Architecture



## IDS Deployment
### IDS Deployment Overview
##### IDS Deployment Methods
入侵检测系统的管理和部署
- 多种**IDS**的协作
- 管理平台和**sensor**

基于**Agent**的**IDS**系统
- Purdue大学研制了一种被称为AAFID(Autonomousagents for intrusion detection)的IDS模型
- SRI的EMERALD(Event Monitoring Enabling Response to Anomalous Live Disturbances)

A typical deployment mode:
![](../../../../../Assets/Pics/Screenshot%202023-12-04%20at%208.38.31AM.png)
##### IDS Deployment Issues
部署中需注意的问题
- 首先在企业中有效地进行IDS的部署，需要大量的**管理机制**为后盾；
- IDS必须被广泛部署在的**关键位置**（不仅仅是互联网连接），才能获得最大的利益；
- **特征库**是否完整、准确对于IDS的检测能力具有决定性的影响；
	- 白名单不足 -> 误报率
	- 黑名单不足 -> 漏报率
- **感应器**的优化是非常重要的，以确保能够准确快速的产生相关告警。
- 需要**大量的资源**来配置、操作和管理；
- **分布式的感应器会产生大量的信息**：
	- 告警信息的汇集加剧；
	- 在特定情况下，许多告警可能无法与入侵行为相关联；
	- 需要大量的人力介入，尤其是在响应方面。
- 管理控制台的安全性问题；
- 感应器与控制台**通信的安全性问题**。


### ⭐ Basic IDS Deployment
![](../../../../../Assets/Pics/Screenshot%202023-12-04%20at%208.40.00AM.png)

检测器放置于防火墙的DMZ区域（部署一）
- 可以查看受保护区域主机被攻击状态
- 可以看出防火墙系统的策略是否合理
- 可以看出**DMZ**区域被黑客攻击的重点

检测器放置于路由器和边界防火墙之间（部署二）
- 可以审计所有来自**Internet**上面对保护网络的攻击数目
- 可以审计所有来自**Internet**上面对保护网络的攻击类型

检测器放在主要的网络中枢（部署三）
- 监控大量的网络数据，可提高检测黑客攻击的可能性
- 可通过授权用户的权利周界来发现未授权用户的行为

检测器放在安全级别高的子网（部署四）
- 对非常重要的系统和资源的入侵检测

检测器放在重要主机上（部署五）

### Real Example: ISS RealSecure
![](../../../../../Assets/Pics/Screenshot%202023-12-04%20at%208.42.09AM.png)

![](../../../../../Assets/Pics/Screenshot%202023-12-04%20at%208.42.23AM.png)

![](../../../../../Assets/Pics/Screenshot%202023-12-04%20at%208.42.42AM.png)

![](../../../../../Assets/Pics/Screenshot%202023-12-04%20at%208.42.56AM.png)



## Ref
[👍 第九章 入侵检测 | 中传信安课程网站]: https://c4pr1c3.github.io/cuc-ns/chap0x09/main.html#95-实战入侵检测系统

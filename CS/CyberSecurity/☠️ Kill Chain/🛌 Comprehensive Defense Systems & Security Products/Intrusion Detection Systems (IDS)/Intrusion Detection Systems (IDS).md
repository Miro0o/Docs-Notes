# Intrusion Detection Systems (IDS)

[TOC]



## Res
【深入浅出计算机网络 - 7.8 防火墙访问控制与入侵检测系统】 https://www.bilibili.com/video/BV1Gr4y1u7oe/?share_source=copy_web&vd_source=7740584ebdab35221363fc24d1582d9d



## Intro
> 边界安全/内生安全，安全左移：改变传统的事后检测、修复的思路，试图在软件产品的开发、测试阶段就考虑到可能的安全威胁并作出防范。

### Overview & Concepts
![](../../../../../Assets/Pics/Screenshot%202023-04-01%20at%204.26.59%20PM.png)

入侵检测(Intrusion Detection)，指对系统的运行状态进行监视，发现各种攻击企图、攻击行为或者攻击结果，以保证系统资源的机密性、完整性和可用性。**进行入侵检测的软件与硬件的组合便是入侵检测系统（Intrusion Detection System，IDS）**

- 警报(Alert)，当一个入侵正在发生或者试图发生时，IDS将发布一个警报信息通知系统管理员。如果控制台与IDS同在一台机器，警报信息将显示在监视器上，也可能伴随着声音提示，如果是远程控制台，那么警报将通过IDS内置方法（通常是加密的）、简单网络管理协议（Simple Network Management Protocol, SNMP)（通常不加密）、电子邮件（Electronic Mail, E-mail）、短信息服务（Short Message Service, SMS）、IM（即时通信）或者以上几种方法的混合方式传递给管理员。
- 异常（Anomoly），当有某个事件与一个已知攻击的信号相匹配时，多数IDS都会告警；一个基于异常的 IDS 会构造一个当时活动的主机或网络的大致轮廓，当有一个在这个轮廓以外的事件发生时，IDS 就会告警。
- 特征(Signature)，IDS的核心是攻击特征（签名），它使IDS在（入侵）事件发生时触发警报。如果特征信息过短会经常触发 IDS，导致误报或错报，过长则会减慢IDS的工作速度。将 IDS 所支持的特征数视为 IDS 好坏的标准是评价 IDS 产品优劣的常见误区，例如有的厂商用一个特征涵盖许多攻击，而有些厂商则会将这些特征单独列出，特征数量的多少并不能决定威胁检测能力的高低。

### IDS Development History
![](../../../../../Assets/Pics/Pasted%20image%2020231201095507.png)

🔗 https://c4pr1c3.github.io/cuc-ns/chap0x09/main.html#95-实战入侵检测系统

### IDS Services / Why IDS?
入侵检测可以识别入侵者，识别入侵行为，监视和检测已成功的安全突破，为对抗入侵及时提供重要信息，以阻止事件的发生和事态的扩大，具有如下作用：

1. 实时检测网络系统的非法行为，持续地监视、分析网络中所有的数据报文，发现并及时处理所捕获的数据报文；
2. 安全审计，通过对入侵检测系统记录的网络事件进行统计分析，发现其中的异常现象，为评估系统的安全状态提供相关证据；
3. 不占用被保护系统的任何资源，作为独立的网络设备，可以做到对黑客透明，本身的安全性较高；
4. 主机入侵检测系统运行于被保护系统之上，可以直接保护、恢复系统；

![](../../../../../Assets/Pics/Pasted%20image%2020231201095349.png)
<small>入侵检测系统的作用</small>

在安全体系中，入侵检测系统是通过数据和行为模式判断其风险水平的典型系统:
- 防火墙相当于第一道安全闸门，可以组织一类人群的进入，但无法阻止同一类人群中的破坏分子，也不能组织内部的破坏分子，也不能组织内部的破坏分子；
- 访问控制系统可以不让低级权限的人做越权工作，但无法保证拥有高级权限的人不做破坏行为，也无法保证低级权限的人通过非法行为获得高级权限。

入侵检测系统可以说是防火墙系统的合理补充和有力延伸，它的目的是为响应决策提供威胁证据，在不影响网络部署的前提下，实时、动态地检测来自内部和外部的各种攻击，及时、准确、全面的发现入侵。这可以有效覆盖到防火墙检测和保护的盲区，通过与防火墙协同联动，达到有效网络安全防护。

### IDS Metrics
入侵检测系统主要从以下方面进行的评价：
- 可靠性，指系统的容错能力和可持续运行能力；
- 可用性，指系统开销大小，对网络性能影响的大小；
- 可测试，指系统能够通过模拟攻击进行检测测试；
- 适应性，指系统易于开发和扩展；
- 实时性，指系统能够及早发现入侵企图；
- 安全性，指系统可确保自身的安全；
- 准确性，指系统正确识别入侵行为的能力。

其中，准确性主要通过误报率和漏报率进行评估，误报率和漏报率是衡量入侵检测系统效率的两个重要指标。在我国，入侵检测系统的评价有国家标准：[《信息安全技术 网络入侵检测系统技术要求和测试评价方法 GB/T 20275-2013》](http://std.samr.gov.cn/gb/search/gbDetailed?id=71F772D8069AD3A7E05397BE0A0AB82A) 。

误报率（False Positive Rate ，FPR）的计算公式为:
```
FPR = FP / N
```

漏报率（False Negative Rate ，FNR)的计算公式为：
```
FNR = FN / N
```

其中，N 是警报总数，FP 是误报事件总数。FN 为漏报事件总数。最理想的入侵检测系统的评估结果是误报率 FPR=0 且漏报率 FNR=0，但实际上误报率和漏报率常常是成反比的。

![](../../../../../Assets/Pics/Screenshot%202023-04-01%20at%204.27.36%20PM.png)

### Types of IDS
![](../../../../../Assets/Pics/Screenshot%202023-04-01%20at%204.27.24%20PM.png)



## IDS Key Technologies
### IDS Basic Technologies

### IDS Architecture



## 📐 IDS Standardization /Frameworks
### CIDF (Common Intrusion Detection Framework)


### OPSEC (Open Platform for Security)



## Ref
[👍 第九章 入侵检测 | 中传信安课程网站]: https://c4pr1c3.github.io/cuc-ns/chap0x09/main.html#95-实战入侵检测系统

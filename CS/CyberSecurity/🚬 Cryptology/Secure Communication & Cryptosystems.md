# Secure Communication & Cryptosystems

[TOC]



## Res
↗ [Cryptology](Cryptology.md)

↗ [Cybersecurity Basics & InfoSec](../🏰%20Cybersecurity%20Basics%20&%20InfoSec/Cybersecurity%20Basics%20&%20InfoSec.md)



## Intro
### Objectives of Secure Communication
↗ [Cybersecurity Basics & InfoSec /🛡️ InfoSec Principles & Objectives](../🏰%20Cybersecurity%20Basics%20&%20InfoSec/Cybersecurity%20Basics%20&%20InfoSec.md#🛡️%20InfoSec%20Principles%20&%20Objectives)



## ✨ Principles of Secure Communication
![](../../../Assets/Pics/Screenshot%202023-03-01%20at%208.48.15%20PM.png)
<small>An example: asymmetric secure communication model</small>

### 🛕 Cryptosystems (密码体制)
通常一个密码体制可以有如下几个部分:
1. 消息空间 M(又称明文空间): 所有可能明文 m 的集合;
2. 密文空间 C: 所有可能密文 c 的集合;
3. 密钥空间 K: 所有可能密钥k的集合，其中每一密钥k由加密密钥ke和解密密钥kd组成，即k=(ke，kd);
4. 加密算法 E: 一簇由加密密钥控制的、从 M 到 C 的加密变换;
5. 解密算法 D: 一簇由解密密钥控制的、从 C 到 M 的解密变换。

五元组 $$\{ M，C，K，E，D \}$$就称为一个密码系统。在密码系统中，对于每一个确定的密钥k，加密
算法将确定一个具体的加密变换，解密算法将确定一个具体的解密变换，而且解密变换就是加密变换的 逆变换。对于明文空间M中的每一个明文m，加密算法E在加密密钥ke的控制下将明文m加密成密文c; 而解密算法D则在密钥kd的控制下将密文c解密成同一明文m，即:

对 $$m∈M，(ke，kd)∈K，$$有 $$D_kd (Eke (m))=m。$$


### Measurement of Cryptosystem's Security 
#### 密码系统的安全性
一个密码系统的安全性主要与两个方面的因素有关。

1. **密码算法本身**的安全强度

密码算法的安全强度取决于密码设计水平、破译技术等。可以说一个密码系统所使用密码算法的安全强度是 该系统安全性的技术保证。

2. 密码系统的管理或使用中的漏洞 （**密码算法外**的不安全因素）

另外一个方面就是密码算法之外的不安全因素。因为即使一个密码算法能够达到足够高的安全强度，但攻击者却有可能通过其他非技术手段(例如用社会工程手段收买相关密钥管理人员)攻破一个密码系统。这些不安全因素来自于密码系统的管理或使用中的漏洞。

> 因此，密码算法的保密强度并不等价于密码系统整体的安全性。一个密码系统必须同时完善技术与管理要求，才能保证整个密码系统的安全。本教材仅讨论影响一个密码系统安全性的技术因素，即密码 算法本身。

#### 密码系统安全性的评估
1. **无条件安全性**
这种评价方法考虑的是假定攻击者拥有无限的计算资源，但仍然无法破译该密码系统。按照信息论的观点就是，攻击者观察密文前后明文的不确定性相等，也即攻击者通过观察密文不会得到任何有助于破译密码系统的信息。这种密码系统就是理论上不可破译的，或者称该密码体制具有完善保密性(Perfect Secrecy )或无条件安全性。

> 1918 年，AT&T 工程师 Gilbert Vernam 发明的**一次一密(OTP)密码方案**是最早被人们认识的无条件安全的密码体制。这种密码系统使用与消息一样长的随机密钥，且密钥使用永不重复，由于它产生不带有与明文有任何统计关系的随机输出，这种方案如果被正确使用，就是理论上不可破译的密码系统。但这一方案虽然安全性能卓越，但实际上不实用，因为其密钥生成十分困难，密钥不能重复使用，密钥管理成为一个非常艰难的问题，完全的一次一密密码体制往往只具有理论上的意义。

2. **可证明安全性**
这种方法是将密码系统的安全性归结为某个经过深入研究的数学难题(如大整数素因子分解、计算 离散对数等)，数学难题被证明求解困难。这种评估方法存在的问题是它只说明了这个密码方法的安全 性与某个困难问题相关，没有完全证明问题本身的安全性，并给出它们的等价性证明。

3. **计算安全性**
计算安全性又称为实际安全性，这种评价方法是指使用目前最好的方法攻破该密码系统所需要的计 算远远超出攻击者的计算资源水平，则可以定义这个密码系统是安全的。

🎤 综上，一个密码系统要达到实际安全性，就要满足以下准则:  
1. 破译该密码系统的实际计算量(包括计算时间或费用)十分巨大，以致于在实际上是无法实现的;
2. 破译该密码系统所需要的计算时间超过被加密信息有用的生命周期。例如，战争中发起战斗攻击的作战命令只需要在战斗打响前需要保密;重要新闻消息在公开报道前需要保密的时间往往也只有几个小时;
3. 破译该密码系统的费用超过被加密信息本身的价值;

如果一个密码系统能够满足以上准则之一，就可以认为是满足实际安全性的。对于实际应用中的密码系统而言，由于至少存在一种破译方法，即强力攻击法，因此都不能满足无条件安全性，只提供计算安全性。


### Design Principles of Cryptosystems
Kerckhoffs principle

> 🔗 https://en.wikipedia.org/wiki/Kerckhoffs%27s_principle#Explanation_of_the_principle

>  在设计和评估密码系统时还应当遵循公开设计原则，这就是著名柯克霍夫斯（Kerckhoffs）原则。其核心内容是：即使密码系统中的算法为密码分析者所知，也难以从截获的密文推导出明文或密钥。也就是说，密码体制的安全性仅应依赖于对密钥的保密，而不依赖对算法的保密。只有在假设攻击者对密码算法有充分的研究，并且拥有足够的计算资源的情况下仍然安全的密码才是安全的密码系统。 
>  
>  不把密码系统的安全性建立在算法的保密上意味着密码算法可以公开，也可以被分析，即使攻击者知道密码算法也没有关系。对于商用密码系统而言，公开密码算法的优点包括以下几个方面：
>  1. 有利于对密码算法的安全性进行公开测试评估；
>  2. 防止密码算法设计者在算法中隐藏后门；
>  3. 易于实现密码算法的标准化；
>  4. 有利于使用密码算法产品的规模化生产，实现低成本和高性能。
> 
>  但是必须要指出的是，密码设计的公开原则并不等于所有的密码算法在应用时都一定要公开密码算法。


### Types of Cryptosystems
#### 1️⃣ Key Specific (根据密码算法所用的密钥数量)
对称密码体制(Symmetric cipher，也称为单钥密码体制、秘密密钥密码体制、 对称密钥密码体制或常规密码体制)

非对称密码体制(Asymmetric cipher，也称为双钥密码体制、公开密钥密码体制、非对称密钥密码体制)

> 由于非对称密码体制的安全性一般是依赖于某个公认的数学难题，普遍认为其安全性没有对称密码 体制高。

#### 2️⃣ Encryption Specific (根据对明文信息的处理方式)
分组密码(Block cipher)

序列密码(Stream cipher，也称为流密码)

#### 3️⃣ Reversible Specific (根据是否能进行可逆的加密变换)
单向函数密码体制

双向变换密码体制

#### Other cutting-edge Cryptosystems...
Identity-Based Encryption, IBE
Attribute-Based Encryption, ABE
Functional Encryption, FE
Full Homomorphic Encryption, FHE
Deniable Encryption



## 🌅 Secure Communication with CIA Properties
![](../../../../../Assets/Pics/Screenshot%202023-06-05%20at%2010.09.26%20PM.png)

![](../../../../../Assets/Pics/Screenshot%202023-06-05%20at%2010.09.38%20PM.png)



## 🤺 Threats in Secure Communication & Mechanisms
↗ [Cybersecurity Basics & InfoSec /🛡️ InfoSec Principles & Objectives](../🏰%20Cybersecurity%20Basics%20&%20InfoSec/Cybersecurity%20Basics%20&%20InfoSec.md#🛡️%20InfoSec%20Principles%20&%20Objectives)

### 1️⃣ Data Confidentiality


### 2️⃣ Data Integrity
> 数据完整性是防止非法实体对交换数据的修改、插入、替换和删除，或者如果被修改、插入、替换和删除时可以被检测出来。数据完整性可以通过消息认证模式来保证。
#### Data Integrity Mechanisms
##### 👉 通过密码学提供完整性
基于对称密码技术的完整性机制
- 对隐藏数据的相同秘密密钥的理解，有效获得数据的完整性保护
- 这种机制相当于密封

基于非对称密码技术的完整性机制
- 对隐藏数据的公钥对应的私钥的理解，获得数据完整性保护
- 这种机制相当于密封
- 也可以反过来通过数字签名的方式进行保证
###### 通过密封提供完整性
1. 为待保护数据添加一个密码检查值提供完整性。
2. 使用相同的秘密密钥保护和证实数据的完整性。
3. 要么所有的潜在证实者事先知道秘密密钥，要么有访问秘密密钥的方法

对修改的检测方法:
1. 通过密码检验值实现屏蔽未受完整性保护的数据
2. 通过使用数据、密码检验值、秘密密钥，判断数据与密封是否一致来获得。
3. 一旦数据被证实，通过去除密码校验值实现去屏蔽
###### 通过数字签名提供完整性
数字签名是通过一个私有密钥和一个非对称密码算法进行计算的。被屏蔽数据（数据加上附加的数字签名）可用相应的公钥进行证实。

对修改的检测方法
- 为受完整性保护的数据附加一个密码检查值，达到数据屏蔽。
- 通过使用收到数据的数字签名以及证实数字签名的算法和公钥完成证实。
- 一旦数据被证实，通过去除密码检查值实现去屏蔽
###### 通过冗余数据加密提供完整性
通过加密可以支持冗余数据的完整性，包括出错检测代码和数字指纹的数据是冗余的，完整性通过加密得到保护。

对修改的检测方法
- 对冗余数据加密实现屏蔽
- 通过解密被屏蔽数据，以及判断它们是否满足原数据应满足的任何不变性，从而获得证实。
- 通过解密被加密数据实现去屏蔽。
##### 👉 通过上下文提供完整性
通过在一个或多个预先达成共识的上下文条件下，存储或传送数据的机制得到支持。
###### 数据重复
基于数据在空间或时间上的重复出现。通常假定攻击者不能同时损毁超过某个有限数目的复制件，一旦任何数据检测到攻击，数据都可从原拷贝进行重构。

提供完整性的方式
- 通过依时间顺序或在不同场所提供同一个数据的多份拷贝，达到屏蔽数据的目的。
- 通过收集每个给定时间或地点的拷贝，作出比较以达到证实目的。
- 通过选择某个预定的最小度量值作
###### 预共识上下文
提供完整性保护数据的删除检测服务，常与其它完整性机制结合使用。
- 在给定偏差范围内的特定时间和/或地点上提供数据，达到屏蔽的目的；
- 在给定的时间和或地点上预期得到数据实现证实目的；如果预期数据不存在，断定数据发生了完整性损坏。
##### 👉 通过探测和确认提供完整性
- 使用一种总是执行正馈等幂运算的完整性探测。
- 正馈等幂：多次循环执行的运算都产生惟一的结果，这种运算被认为是等幂的。
- 这种机制不适用于数据存储。
- 通过重复相同的动作，直到完整性策略作出否认指示，或者收到一个肯定的确认，从而实现屏蔽。
- 对每份被屏蔽数据都实行证实，成功的证实会 向实施屏蔽操作的实体发出肯定的确认信号。
##### 👉 通过阻止提供完整性
- 通过阻止对数据存储或传输媒体的物理访问。
- 通过访问控制提供。
#### Data Integrity Mechanisms' Matrixs (数据完整性特性机制的评价标准)
- 完整性验证的安全性
	- 消息完整性安全要求对接收的数据的任何改动都能被发现，对于给定的消息m1和其验证码H（m1），找到满足m2≠m1，且H（m2）＝H（m1）的m2在计算上不可行
- 完整性验证中加密的安全
	- 数据完整性验证的一些机制需要对其中的内容进行加密，例如摘要
- 数据完整性验证的信息有效率
	- 数据完整性验证的有效率是指原信息部分长度与合并后总信息（包括原消息和验证码）的长度之比。
- 完整性验证算法的性能
	- 数据完整性验证包括发送方计算验证码，进行加密，接收方重新计算验证码，进行解密，比较等。
#### Data Integrity Mechanisms Instances

##### 基于数据校验思想的数据完整性验证机制
##### 基于消息摘要的完整性验证机制
##### 基于消息认证码（MAC）的数据完整性验证机制
##### 基于错误检测码与对称密钥加密的完整性验证机制
##### 基于RSA的数字签名的完整性验证机制
##### 基于非对称密钥和对称密钥结合的完整性验证机制


### 3️⃣ Data Availability (Authentication & Recovery)
↗ [Authentication (身份鉴别)](../🏰%20Cybersecurity%20Basics%20&%20InfoSec/Identity%20&%20Access%20Management%20(IAM)/Access%20Control/Authentication%20(身份鉴别)/Authentication%20(身份鉴别).md)
↗ [Identification (身份证明)](../🏰%20Cybersecurity%20Basics%20&%20InfoSec/Identity%20&%20Access%20Management%20(IAM)/Identification%20(身份证明)/Identification%20(身份证明).md)
↗ [Data Security](../Data%20Security/Data%20Security.md)


### 4️⃣ Non-Repudiation
> 抗抵赖机制旨在生成、收集、维护有关已声明的事件或动作的证据，并使该证据可得并且确认该证据，以此来解决关于此事件或动作发生或未发生而引起的争议。

用户不可抵赖性机制的评价标准
- 抗抵赖性**机制的安全性**
	- 最重要的标准就是是否能真正起到抗抵赖的效果，伪造抗抵赖的签名在计算复杂性意义上是否具有不可行性
- 抗抵赖性机制**是否需要第三方参与**
	- 抗抵赖的基本思路有两种，一种是凭借自身特有的特性进行抗抵赖，称为直接数字签名法抗抵赖，另一种是借助可信的第三方进行公证来防止抵赖行为，称为仲裁数字签名抗抵赖机制
- 抗抵赖性机制的**信息有效率**
- 抗抵赖性机制**是否具有双向抗抵赖功能**
	- 可抵赖性有两个方面，一方面是发送信息方不可抵赖，
	- 另一方面是信息的接收方的不可抵赖性。
- 抗抵赖性机制是**否同时具有保密，完整性验证作用**
- 抗抵赖性**机制的性能**
	- 发送方计算消息摘要，进行私钥签名，接收方进行验证签名（解密）等。

#### Non-Repudiation Mechanisms
##### 使用TTP安全令牌的抗抵赖技术

##### 使用安全令牌和防篡改模块的抗抵赖技术

##### 使用数字签名的抗抵赖技术

##### 使用时间戳的抗抵赖技术

##### 使用在线可信第三方的抗抵赖技术

##### 使用公证的抗抵赖技术
#### Non-Repudiation Mechanisms' Matrixs (用户不可抵赖性机制的评价标准)
- 抗抵赖性机制的安全性
	- 最重要的标准就是是否能真正起到抗抵赖的效果，伪造抗抵赖的签名在计算复杂性意义上是否具有不可行性
- 抗抵赖性机制是否需要第三方参与
	- 抗抵赖的基本思路有两种，一种是凭借自身特有的特性进行抗抵赖，称为直接数字签名法抗抵赖，另一种是借助可信的第三方进行公证来防止抵赖行为，称为**仲裁数字签名抗抵赖机制**
- 抗抵赖性机制的信息有效率
- 抗抵赖性机制是否具有双向抗抵赖功能
	- 可抵赖性有两个方面，一方面是发送信息方不可抵赖，另一方面是信息的接收方的不可抵赖性
- 抗抵赖性机制是否同时具有保密，完整性验证作用
- 抗抵赖性机制的性能
	- 发送方计算消息摘

#### Non-Repudiation Mechanisms Instances
##### 基于**RSA**的数字签名抗抵赖机制
##### 具有保密作用的**RSA**签名抗抵赖
##### 基于数字信封的数字签名抗抵赖
##### 具有数据完整性检测的数字签名抗抵赖
##### 具有保密性和数据完整性检测的数字签名方法
##### 双方都不能抵赖的数字签名抗抵赖机制
##### 基于第三方仲裁的不可抵赖机制


### 4️⃣ Relay Attacks


### 5️⃣ Impersonation Attacks



## Ref


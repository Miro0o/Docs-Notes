# Password Based Authentication

[TOC]



## Res


## Intro



## Password Authentication Protocol (PAP)
PAP 鉴别的优点是:简单有效，实用方便，费用低廉，使用灵活。因此，一般的系统(如 Unix，Windows NT，NetWare 等)都提供了对口令鉴别的支持。然而，基于简单口令的鉴别方法有许多脆弱性，最主要的是口令容易向外部泄露和易于猜测的弱口令。另外还有线路窃听和重放等威胁。

为提高 PAP 鉴别的安全性，对口令有一定的要求:
1. 口令有一定的长度和复杂度，不能使用简单的 111、123、123456、生日、电话号码或姓名拼音，因为这些很容易被猜测出来，一般应使用 8 位以上，混合大小写字母、数字和特殊符号的口令，防止字典攻击;
2. 口令应定期或不定期修改:口令使用较长时间后，应进行更改，防止可能的泄露;在怀疑口令可能泄露的情况下，也应及时更改口令;
3. 口令应安全保存。明文口令文件需读和写保护，加密口令文件需写保护。


### Enhanced PAP
#### PAP + Hash
![](../../../../../../../../Assets/Pics/Screenshot%202023-05-31%20at%204.00.39%20PM.png)

由于散列函数具有单向性，即从输入变量值计算出函数值容易，而要从函数值逆向计算 出输入变量的值计算不可行，因此常常通过该类函数对口令进行(单向)加密，验证方只保 存口令加密后的信息。鉴别时将口令加密后的信息进行对比验证。鉴别交互示意如图 8.1 所 示。其中，p’是声称者输入的口令信息，id 是声称者的标识，h 是散列函数。p’经过 h 的计 算得到 q’。q 和 id 是验证者保留的散列之后的口令和对应的声称者标识。声称者输入 p’和 id，经过散列函数 h 计算得到 q’。q’连同声称者标识 id 传给验证者，验证者验证 q’是否与 q 相同。如相同，则鉴别通过;否则，鉴别不通过。

该方案的主要缺陷是:利用已知的散列函数，攻击者很容易构造一张 p 与 q 对应的表(称 为口令字典)，表中的 p 是猜测的口令，尽可能包含各种可能的口令值，q 是 p 的散列值。 然后攻击者通过拦截鉴别信息 q，利用口令字典就能以很高的概率获得声称者的口令，这种攻击方式称为**字典攻击**。


#### PAP + Hash + Salt
![](../../../../../../../../Assets/Pics/Screenshot%202023-05-31%20at%204.00.54%20PM.png)

salt 使得使用字典攻击变得更困难。



## One Time Password (OTP)
OTP(One-Time Password)是一次性口令机制，主要目的是确保在每次鉴别中所使用的 加密口令不同，以对付重放攻击。OTP 主要的实现方式有三种:
- 第一种是质询-响应方式。 鉴别时，系统随机给出一个信息，用户将该信息连同其鉴别信息(可能经过计算处理)提交 系统进行鉴别;
- 第二种方法采用时钟同步机制，与质询-响应方式的差异是随机信息是同步 时钟信息。
- 第三种方法是采用 S/KEY 一次性口令身份鉴别协议。


### Challenge /Response (质询/响应 ｜ 挑战/应答)

![](../../../../../../../../Assets/Pics/Screenshot%202023-05-31%20at%204.06.52%20PM.png)

在该机制中，产生非重复值的能力完全掌握在验证者手中。因而􏰁供了一种很好的重放 检测能力。然而，附加的复杂协议意味着这种机制不能与传统的简单口令协议结合使用。

质询—响应的身份鉴别，其安全性一方面取决于散列函数的安全性;另一方面，由于是单向鉴别，还存在着验证者的假冒和重放攻击。这可以通过双向鉴别或时间戳来解决。例如， 在系统每次输出的密文信息中附加日期与时间信息，鉴别双方都可以根据密文中的日期时间 来判断消息是否是当前的。如果是前面的消息重放，用户则拒绝给出回答。


### Time-Synchronization (时间同步)


### Event-Synchronization (事件同步)


### S/KEY



## Ref


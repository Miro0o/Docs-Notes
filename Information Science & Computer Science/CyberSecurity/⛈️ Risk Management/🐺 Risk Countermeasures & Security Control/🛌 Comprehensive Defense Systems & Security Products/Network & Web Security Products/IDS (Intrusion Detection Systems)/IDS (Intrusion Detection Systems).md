# IDS (Intrusion Detection Systems)

[TOC]



## Res
【深入浅出计算机网络 - 7.8 防火墙访问控制与入侵检测系统】 https://www.bilibili.com/video/BV1Gr4y1u7oe/?share_source=copy_web&vd_source=7740584ebdab35221363fc24d1582d9d

### Related Topics
↗ [DPI (Deep Package Inspection)](../Firewall%20&%20Network%20Filters/DPI%20(Deep%20Package%20Inspection)/DPI%20(Deep%20Package%20Inspection).md)



## Intro
> 边界安全/内生安全，安全左移：改变传统的事后检测、修复的思路，试图在软件产品的开发、测试阶段就考虑到可能的安全威胁并作出防范。

![](../../../../../../../../Assets/Pics/Screenshot%202023-12-04%20at%208.58.45AM.png)


### 🤔 Threats & Intrusion
入侵（**Intrusion**）是指在非法或未经授权的情况下，试图存取或处理系统或网络中的信息，或破坏系统或网络正常运行，致使系统或网络的机密性、完整性和可用性受到破坏的故意行为（获取数据/破坏基础设施）


### IDS Overview & Concepts
![](../../../../../../../../Assets/Pics/Screenshot%202023-04-01%20at%204.26.59%20PM.png)

> 入侵检测（**Intrusion Detection**）是对入侵行为的发觉。它通过计算机网络或计算机系统的关键点采集信息并进行分析，从中发现网络或系统中是否有违反安全策略的行为和被攻击的迹象。
> 入侵检测系统（**Intrusion Detection System**，简称**IDS**）是指实现入侵检测功能的软件和硬件的集合。

入侵检测(Intrusion Detection)，指对系统的运行状态进行监视，发现各种攻击企图、攻击行为或者攻击结果，以保证系统资源的机密性、完整性和可用性。**进行入侵检测的软件与硬件的组合便是入侵检测系统（Intrusion Detection System，IDS）**
- **警报(Alert)**，当一个入侵正在发生或者试图发生时，IDS将发布一个警报信息通知系统管理员。如果控制台与IDS同在一台机器，警报信息将显示在监视器上，也可能伴随着声音提示，如果是远程控制台，那么警报将通过IDS内置方法（通常是加密的）、简单网络管理协议（Simple Network Management Protocol, SNMP)（通常不加密）、电子邮件（Electronic Mail, E-mail）、短信息服务（Short Message Service, SMS）、IM（即时通信）或者以上几种方法的混合方式传递给管理员。
- **异常（Anomoly）**，当有某个事件与一个已知攻击的信号相匹配时，多数IDS都会告警；一个基于异常的 IDS 会构造一个当时活动的主机或网络的大致轮廓(profile)，当有一个在这个轮廓以外的事件发生时，IDS 就会告警。
- **特征(Signature)**，IDS的核心是攻击特征（签名），它使IDS在（入侵）事件发生时触发警报。如果特征信息过短会经常触发 IDS，导致误报或错报，过长则会减慢IDS的工作速度。
	- 将 IDS 所支持的特征数视为 IDS 好坏的标准是评价 IDS 产品优劣的常见误区，例如有的厂商用一个特征涵盖许多攻击，而有些厂商则会将这些特征单独列出，**特征数量的多少并不能决定威胁检测能力的高低。**

IDS存在与发展的必然性
- 网络攻击造成的破坏性和损失日益严重
- 网络安全威胁日益增长
- 单纯的防火墙无法防范复杂多变的攻击

IDS 工作流程：
- 预防入侵
	- 非常重要的第一步；
	- 阻止某些不良企图，例如防火墙无法检查和控制的；
	- 但是攻击仍然发生：
		- 网络、操作系统和应用在设计和实现上的缺陷；
		- 隧道技术；
		- 来自网络内部的攻击。
- 检测入侵
	- 是否能够实时检测到剩余的攻击?
	- 监控各种恶意行为：
		- 网络流量;
		- 主机中的行为;
	- 实时分析大量的审计数据，来识别入侵或误用。
- 对入侵做出响应
	- 实时响应；
	- 识别入侵并做出响应；
	- 做出反应以减小入侵造成的影响，并尽快恢复服务。
	- **入侵的响应方式**
		- IDS控制台显示告警信息；
		- 通过电子邮件向管理员发送告警信息；
		- 根据预先设定的规则阻断连接；
			- **IDS**自身阻断
			- 与防火墙联动
		- 采取事件归并，以确保响应机制不被入侵者利用，导致拒绝服务。

IDS 作用：智能发现攻击，记录并发出报警信息，启动响应动作；
- 克服某些传统的防御机制的限制；
- 在“深度防御”的基础上成为安全框架的一部分；
- 在整个组织的网络中能够识别入侵或违反安全策略的行为，并能够做出回应

IDS 功能
- 自动检测入侵行为；
- 监视网络流量（Network IDS)和主机(HostIDS)中的操作；
- 分析入侵行为：
	- 基于特征
	- 基于异常
- 按预定的规则做出响应：
	- 阻止指定的行为


### IDS Development History
![](../../../../../../../../Assets/Pics/Pasted%20image%2020231201095507.png)

🔗 https://c4pr1c3.github.io/cuc-ns/chap0x09/main.html#95-实战入侵检测系统


### Why IDS?
#### Non-IDS Defaults
传统的信息安全方法采用严格的访问控制和数据加密策略来保护，但在复杂系统中，这些策略是不充分的，它们是系统安全不可缺的部分但不能完全保证系统的安全
- 安全是过程
- 不仅仅是人！不仅仅是设备！IDS是安全的一部分！

入侵入门很容易
- 入侵教程随处可见
- 各种工具唾手可得

单一防护产品的弱点
- 防御方法和防御策略的有限性
- 动态多变的网络环境
- 来自外部和内部的威胁

防火墙为例：
- 网络边界的设备，只能抵挡外部來的入侵行为
- 自身存在弱点，也可能被攻破
- 对某些攻击保护很弱
- 即使透过防火墙的保护，合法的使用者仍会非法地使用系统，甚至提升自己的权限
- 仅能拒绝非法的连接請求，但是对于入侵者的攻击行为仍一无所知

![](../../../../../../../../Assets/Pics/Screenshot%202023-12-04%20at%209.04.01AM.png)
#### IDS Services
入侵检测可以识别入侵者，识别入侵行为，监视和检测已成功的安全突破，为对抗入侵及时提供重要信息，以阻止事件的发生和事态的扩大，具有如下作用：
1. 实时检测网络系统的非法行为，持续地监视、分析网络中所有的数据报文，发现并及时处理所捕获的数据报文；
2. 安全审计，通过对入侵检测系统记录的网络事件进行统计分析，发现其中的异常现象，为评估系统的安全状态提供相关证据；
3. 不占用被保护系统的任何资源，作为独立的网络设备，可以做到对黑客透明，本身的安全性较高；
4. 主机入侵检测系统运行于被保护系统之上，可以直接保护、恢复系统；

![](../../../../../../../../Assets/Pics/Pasted%20image%2020231201095349.png)
<small>入侵检测系统的作用</small>

在安全体系中，入侵检测系统是通过**数据和行为模式**判断其风险水平的典型系统:
- 防火墙相当于第一道安全闸门，可以组织一类人群的进入，但无法阻止同一类人群中的破坏分子，也不能组织内部的破坏分子，也不能组织内部的破坏分子；
- 访问控制系统可以不让低级权限的人做越权工作，但无法保证拥有高级权限的人不做破坏行为，也无法保证低级权限的人通过非法行为获得高级权限。

入侵检测系统可以说是防火墙系统的合理补充和有力延伸，它的目的是为响应决策提供威胁证据，在不影响网络部署的前提下，实时、动态地检测来自内部和外部的各种攻击，及时、准确、全面地发现入侵。这可以有效覆盖到防火墙检测和保护的盲区，通过与防火墙协同联动，达到有效网络安全防护。


### ⭐ IDS Metrics
入侵检测系统主要从以下方面进行的评价：
- 可靠性，指系统的容错能力和可持续运行能力；
- 可用性，指系统开销大小，对网络性能影响的大小；
- 可测试，指系统能够通过模拟攻击进行检测测试；
- 适应性，指系统易于开发和扩展；
- 实时性，指系统能够及早发现入侵企图；
- 安全性，指系统可确保自身的安全；
- 准确性，指系统正确识别入侵行为的能力。

Porras等给出了评价入侵检测系统性能的三个因素
- 准确性（Accuracy）--误报率
	- 把正常事件识别为攻击并报警
	- 误报率与**检出率**成正比例关系
- 处理性能（Performance）
- 完备性（Completeness）--漏报率
	- 指攻击事件没有被IDS检测到
Debar等增加了两个性能评价测度
- 容错性（Fault Tolerance）：IDS自身防御攻击的能力
- 及时性（Timeliness）：数据源分析的速度

其中，**准确性主要通过误报率和漏报率进行评估**，误报率和漏报率是衡量入侵检测系统效率的**两个重要指标**。在我国，入侵检测系统的评价有国家标准：[《信息安全技术 网络入侵检测系统技术要求和测试评价方法 GB/T 20275-2013》](http://std.samr.gov.cn/gb/search/gbDetailed?id=71F772D8069AD3A7E05397BE0A0AB82A) 。

误报率（False Positive Rate ，FPR）的计算公式为:
```
FPR = FP / N
```

漏报率（False Negative Rate ，FNR)的计算公式为：
```
FNR = FN / N
```

其中，N 是警报总数，FP 是误报事件总数。FN 为漏报事件总数。最理想的入侵检测系统的评估结果是误报率 FPR=0 且漏报率 FNR=0，但实际上误报率和漏报率常常是成反比的。

![](../../../../../../../../Assets/Pics/Screenshot%202023-04-01%20at%204.27.36%20PM.png)


### Issues Faced IDS
- 误警率高
	- IDS的虚警率和漏警率之和即为误警率，误警问题已成为制约其发展的关键技术问题。
- 缺少统一的构建方法学
	- IDS系统内缺少结构化的方法学，同时入侵检测系统的内部缺乏有效的信息共享和协同机制，限制了对攻击的检测能力。
- 自学习能力差
	- 添加IDS检测规则常依赖于手工方式且更新缓慢，限制了IDS的可用性。
- 自身易受攻击
	- IDS本身是存在漏洞的软件程序，它容易成为黑客攻击的目标，一旦黑客攻击成功，那它所管理的网络安全就不能得到保证



## IDS Taxonomy
### 1️⃣ 检测分析技术方法
![](../../../../../../../../Assets/Pics/Screenshot%202023-04-01%20at%204.27.24%20PM.png)

异常检测：通过采集和统计来发现网络或系统中可能出现的异常行为，向管理员提出警告。
- 知识库为正常流量特征/规律，对不在正常流量知识中的行为报警
特征检测：通过对采集的信息按已知的知识进行分析，来发现正在发生和已经发生的入侵行为。
- 知识库为非正常流量特征/规律，对在非正常知识中的行为报警

二分类问题。对其中一类问题进行学习即可进行二分类判断。

|分析策略 | 特征检测 | 异常检测|
|-|-|-|
| 缺省即允许 | 基于信号的特征检测 | 基于机器学习的异常检测| 
| 缺省即禁止 | 基于策略的特征检测 | 基于轮廓的异常检测|
#### Anomaly Detection（基于特征的检测）
- 也称为基于行为的检测
- **基于黑名单，漏报率高**
- 首先建立起用户的正常使用模式，即知识库
- 标识出不符合正常模式的行为活动
- 假设所有的入侵行为是异常的；
- 基于系统和基于用户的异常；

比较符合安全的概念，但是实现难度较大
- 正常模式的知识库难以建立
- 难以明确划分正常模式和异常模式

优点：
- 可检测未知的攻击；
- 自适应、自学习功能；
- 不需要先验知识?

使用的检测方法
- 基于统计方法的入侵检测技术
- 基于神经网络的入侵检测技术
- 基于专家系统的入侵检测技术
- 基于模型推理的入侵检测技术

数据来源
- 审计日志或网络流量
- 特殊用途的数据收集机制
- ……

关键问题：
- “正常”行为特征的选择；
- 统计算法、统计点的选取等。
##### Anomaly Detection Technology
#### Misuse Detection（基于异常的检测）
- 也称为误用检测
- **白名单，误报率高**
- 是针对已知（类似）的攻击行为和间接的违背系统安全策略行为的检测，攻击和系统漏洞库是特征检测的基础。
- 建立入侵行为模型(攻击特征库)；
- 判别当前行为活动是否符合已知的攻击模式
- 假设可以识别和表示所有可能的特征；
- 基于系统的和基于用户；
- 目前研究工作比较多，并且已经进入实用

优点：
- 准确率高；
- 算法简单。

关键问题：
- 有所有的攻击特征，建立完备的特征库；
- 特征库要不断更新（动态性）；
- 无法检测新的入侵。

数据来源
- 审计日志或网络流量
- 特殊用途的数据收集机制
##### Misuse Detection Technology
### 2️⃣ 按检测范围
#### Host IDS (HIDS)
- 基于主机的入侵检测系统是以代理软件的形式安装在每台主机或服务器上，以监测主机上的各种活动；
- 代理软件实现对入侵的检测分析；
- 由代理软件向统一的管理/策略服务器发送日志和告警信息。

按照检测对象的不同，基于主机的入侵检测系统可以分为两类：
- 网络连接检测（出入本机的流量）
- 主机文件检测

**主机入侵检测系统的优点**
- 在长期监控谁访问什么
- 可以将问题映射到一个具体的用户ID
- 系统可以跟踪滥用行为的变化
- **适用于加密环境（通信加密）**
	- 与网络入侵检测系统不同。HIDS无法处理加密数据。
- 可以运行在交换环境中
- 监测分布在多台主机上的负载，并只将有关数据上报中央控制台

**主机入侵检测系统的缺点**
- **无法监测网络活动（本机之外的网络活动）**；
	- 但是可以监测本机的网络活动。
- 占用系统资源
	- 审计机制的运行增加了系统负载；
	- 审计记录会占用大量的存储空间；
- 代理软件带来的问题
	- 操作系统的漏洞可能破坏代理软件的有效性；
	- 不同类型的操作系统需要不同的代理软件；
		- 随着技术的发展这个问题有希望被解决。
		- C/C++语言的应用程序与底层OS强相关，但是Java/JS/Python/Go等较高语言的出现使得应用程序与底层OS解耦。开发者可以使用上述高级语言进行应用开发，然后使用打包技术将同一份代码适配到不同底层环境，这样开发者就无需分散精力去维护和OS相关的适配。
- 运维成本
	- 升级的问题,每台机器都要升级；
	- 更高的部署和维护成本。
##### 1️⃣ Network Connection Detection（网络连接检测）
> 主要是检测出入主机的流量，与HIDS不太一样。

- 网络连接检测是对试图进入该主机的数据流进行检测，分析确定是否有入侵行为。
- 网络连接检测可以有效地检测出是否存在攻击探测行为。
- 攻击探测几乎是所有攻击行为的前奏。
	- 系统管理员可以设置好访问控制表，其中包括容易受到攻击探测的网络服务，并且为它们设置好访问权限。如果入侵检测系统发现有对未开放的服务端口进行网络连接，说明有攻击者在寻找系统漏洞，这些探测行为就会被入侵检测系统记录下来。
- 未经授权的连接也列入检测对象
##### 2️⃣ Host File Detection（主机文件检测）
通常入侵行为会在主机的各种相关文件中留下痕迹，主机文件检测能够帮助系统管理员发现入侵行为或入侵企图，及时采取补救措施。
主机文件检测的检测对象主要包括以下几种：
1. 系统日志
	1. 系统日志文件中记录了各种类型的信息，包括各用户的行为记录。如果日志文件中存在着异常的记录，就可以认为已经或正在发生网络入侵行为。这些异常包括不正常的反复登录失败记录、未授权用户越权访问重要文件、非正常登录行为等。
2. 文件系统
	1. 攻击者会修改网络主机上包含重要信息的各种数据文件，可能会删除或者替换某些文件，或者尽量修改各种日志记录来销毁攻击行为可能留下的痕迹。如果入侵检测系统发现文件系统发生了异常的改变，例如一些受限访问的目录或文件被非正常地创建、修改或删除，就可以怀疑发生了网络入侵行为。
3. 进程记录
	1. 主机系统中运行着各种不同的应用程序，包括各种服务程序。每个执行中的程序都包含了一个或多个进程。每个进程都存在于特定的系统环境中，能够访问有限的系统资源、数据文件等，或者与特定的进程进行通信。黑客可能将程序的进程分解，致使程序中止，或者令程序执行违背系统用户意图的操作。如果入侵检测系统发现某个进程存在着异常的行为，就可以怀疑有网络入侵。
##### HIDS Implementation
- 信息收集
	- 系统日志
	- 系统状态信息
	- 特点：OS相关
- 常用的分析技术
	- 统计分析
	- 状态转移分析
	- 关联分析
#### Network IDS (NIDS)
- **以混杂模式接入网络**；
- 感应器可部署在网络的关键位置；
- 将日志/告警信息发送至位于企业防火墙内部的服务器。

**形态**：基于网络的入侵检测系统通常是作为一个独立的个体放置于被保护的网络上
**检测对象**：使用原始的网络分组数据包作为进行攻击分析的数据源
**实现方式**：一般利用一个网络适配器来实时监视和分析所有通过网络进行传输的通信。
**响应方式**：一旦检测到攻击，入侵检测系统应答模块通过通知、报警以及中断连接等方式来对攻击做出反应

检测引擎关键技术
- 模式匹配技术
	- 从网络数据包包头开始和攻击特征比较。
		- 相同，则检测到一个可能攻击
		- 不同，从网络数据包下一个位置重新开始比较。
	- 直至检测到攻击或网络数据包中所有字节匹配完毕，一个攻击特征匹配结束。
	- 对每一个攻击特征，重复前面两步
	- 直到每一个攻击特征匹配完毕，对给定数据包的匹配完毕。
- 协议分析技术

**网络入侵检测系统的优点**：
- 不需重新配置或重定向日志机制即可快速获取信息；
- 其部署不影响现有的网络架构或数据源；
- 实时监视与检测网络攻击或误用；
- 与操作系统无关；
- 不会增加系统开销。

**网络入侵检测系统的缺点**：
- 无法分析加密的数据；
- 从网络流量可以推断发生了什么，但不能判断结果；
- 对全交换网络需要配置交换机端口镜像；
- 对于带宽的要求较高。
##### NIDS Implementation
- 收集网络流量数据
	- 利用**sniff**技术
	- 把**IDS**配置在合理的流量集中点上，比如与防火墙或者网关配置在一个子网中
- 利用某些识别技术
	- 基于模式匹配的专家系统
	- 基于异常行为分析的检测手段

↗ [Snort](IDS%20Implementations/Snort/Snort.md)
#### Network Node IDS
- 安装在网络节点的主机中；
- 结合了NIDS和HIDS的技术；
- 适合于高速交换环境和加密环境。


### 3️⃣ Future Types of IDS (入侵检测系统的发展趋势)
- 分布式入侵检测：异构和大型网络中，系统的复杂度大大增加，模型建立十分困难，需要分布式入侵检测架构。其关键技术是检测信息的协同处理与入侵攻击的全局信息的获取。
- 应用层入侵检测：许多入侵活动的含义只有在应用层才能理解。但传统方法很少涉及到应用层，使得一些应用系统内的入侵活动难以检测，所以需要开发应用层的入侵检测技术。
- 智能入侵检测：智能化的入侵检测技术，使系统能够自动学习新的入侵活动，完善系统模型，提高检测的效率和准确性。
- 综合性监测系统：与其他的网络安全技术相结合，形成综合的检测系统，解决传统方法检测对象单一、检测攻击形式简单的问题。



## IDS Models /Frameworks /Standardization
通用入侵检测模型（**Denning**模型），层次化入侵检测模型（**IDM**），管理式入侵检测模型（**SNMP-IDSM**）


### Denning Model
![](../../../../../../../../Assets/Pics/Screenshot%202023-12-16%20at%2011.45.38AM.png)

在1984年-1986年，在美国海军空间和海军战争系统司令部的资助下，Dorothy Denning给出了通用入侵检测系统模型。
- Denning提出了异常活动和计算机不当使用之间的相关性，该模型独立于任何特殊系统、应用环境、系统脆弱性或入侵种类，是一通用的入侵检测框架。能够检测出Hacker入侵、越权操作及其它种类的非正常使用计算机系统的行为。
- **模型假设**：入侵行为可以通过检查一个系统的审计记录、从中识别异常使用系统的入侵行为。
	- 常使用系统的入侵行为可以通过检查一个系统的审计记录来识别。
	- **可检测**的异常使用系统的行为：
		- 黑客入侵
		- 未授权操作或越权操作
		- 其他
- **Denning**模型实际上是一个基于规则的模式匹配系统。**该模型的最大缺陷在于未包含已知系统漏洞或攻击方法方面的知识**。

![](../../../../../../../../Assets/Pics/Screenshot%202023-12-16%20at%2011.50.09AM.png)


### IDM
IDM将IDS分为六个层次（由低至高）：
- 数据(Data)层
	- 主机操作系统的审计记录
	- 局域网监视器结果
	- 第三方审计软件包提供的数据
- 事件(Event)层
	- 事件描述数据层的内容所表示的含义和固有的特征和性质
	- 数据域：**<Action, Domain>**
		- Action描述了审计记录的动态特征，如进程执行、会话开始
		- Domain描述了审计记录的对象的特征，如标签、鉴别、审计、网络、系统、系统信息、用户信息、应用工具、拥有者和非拥有者等
- 主体(Subject)层
	- 主体用来标识网络中跨越多台主机使用的用户
- 上下文(Context)层
	- 上下文用来说明事件发生时所处的环境，或者给出事件产生的背景
	- 类型
		- 时间型：以某个时间为参考点，利用相关的事件信息来检测入侵，如正常工作时不出现的操作在下班时出现
		- 空间型：说明事件的来源与入侵行为的相关性，事件与特别的用户或主机相关联
	- 事件上下文使得可以对多个事件进行相关性入侵检测
- 威胁(Thread)层
	- 可以根据滥用的特征和对象对威胁进行分类
	- 滥用类型
		- 攻击：表明机器的状态发生了改变
		- 误用：表示越权行为
		- 可疑：入侵检测感兴趣的事件
	- 滥用对象
		- 系统对象、用户对象（如无权限的用户）
		- 被动对象（文件）、主动对象（运行的进程）
- 安全状态(Security State)层
	- 用1-100之间的某个数值来表示网络的安全状态，数字越大表示越不安全

IDM模型给出了在推断网络中的计算机受攻击时数据的抽象过程，即IDM给出了将分散的原始数据转换为高层次的有关入侵和被监测环境的全部安全假设过程IDM通过把收集到的分散数据进行加工抽象和数据关联操作，简化了对跨越单机的入侵行为的识别


### SNMP-IDSM
问题：不同IDS之间信息交换困难。数据格式？语言？

对于多个IDS的协同工作，北卡罗莱那州立大学的Felix Wu等人从网络管理的角度考虑IDS模型，提出基于SNMP的IDS模型，简称SNMP-IDSM。

SNMP-IDSM以SNMP为公共语言来实现IDS系统之间的信息交换和协同检测，它定义了IDS-MIB，使得原始事件和抽象事件之间关系明确，并且易于扩展这些关系。

![](../../../../../../../../Assets/Pics/Screenshot%202023-12-16%20at%2011.55.44AM.png)


### 📐 Common IDS Models
#### CIDF (Common Intrusion Detection Framework)
阐述了一个入侵检测系统的通用模型。
- CIDF将入侵检测系统需要分析的数据统称为事件（Event），事件可以是网络中的数据包，也可以是从系统日志等其他途径得到的信息。
- CIDF讨论关于入侵检测系统协同的问题，主要介绍一种通用入侵说明语言（CISL），即系统事件、分析结果及响应指示的通用表示。把入侵检测系统从逻辑上分为面向任务的组件.
- CIDF试图规范一种通用的语法格式和编码方式以表示在组件边界传递的数据。

![](../../../../../../../../Assets/Pics/Screenshot%202023-12-16%20at%2012.11.49PM.png)
#### OPSEC (Open Platform for Security)



## IDS Key Technologies
### IDS Basic Technologies


### IDS Architecture



## IDS Deployment
### IDS Deployment Overview
#### IDS Deployment Methods
入侵检测系统的管理和部署
- 多种**IDS**的协作
- 管理平台和**sensor**

基于**Agent**的**IDS**系统
- Purdue大学研制了一种被称为AAFID(Autonomous agents for intrusion detection)的IDS模型
- SRI的EMERALD(Event Monitoring Enabling Response to Anomalous Live Disturbances)

![](../../../../../../../../Assets/Pics/Screenshot%202023-12-04%20at%208.38.31AM.png)
<small>A typical deployment mode</small>
#### IDS Deployment Issues
部署中需注意的问题
- 首先在企业中有效地进行IDS的部署，需要大量的**管理机制**为后盾；
- IDS必须被广泛部署在的**关键位置**（不仅仅是互联网连接），才能获得最大的利益；
- **特征库**是否完整、准确对于IDS的检测能力具有决定性的影响；
	- 白名单不足 -> 误报率
	- 黑名单不足 -> 漏报率
- **感应器**的优化是非常重要的，以确保能够准确快速的产生相关告警。
- 需要**大量的资源**来配置、操作和管理；
- **分布式的感应器会产生大量的信息**：
	- 告警信息的汇集加剧；
	- 在特定情况下，许多告警可能无法与入侵行为相关联；
	- 需要大量的人力介入，尤其是在响应方面。
- 管理控制台的安全性问题；
- 感应器与控制台**通信的安全性问题**。


### ⭐ Basic IDS Deployment Methods
![](../../../../../../../../Assets/Pics/Screenshot%202023-12-04%20at%208.40.00AM.png)

检测器放置于防火墙的DMZ区域（部署一）
- 可以查看受保护区域主机被攻击状态
- 可以看出防火墙系统的策略是否合理
- 可以看出**DMZ**区域被黑客攻击的重点

检测器放置于路由器和边界防火墙之间（部署二）
- 可以审计所有来自**Internet**上面对保护网络的攻击数目
- 可以审计所有来自**Internet**上面对保护网络的攻击类型

检测器放在主要的网络中枢（部署三）
- 监控大量的网络数据，可提高检测黑客攻击的可能性
- 可通过授权用户的权利周界来发现未授权用户的行为

检测器放在安全级别高的子网（部署四）
- 对非常重要的系统和资源的入侵检测

检测器放在重要主机上（部署五）


### Real Example: ISS RealSecure
![](../../../../../../../../Assets/Pics/Screenshot%202023-12-04%20at%208.42.09AM.png)

![](../../../../../../../../Assets/Pics/Screenshot%202023-12-04%20at%208.42.23AM.png)

![](../../../../../../../../Assets/Pics/Screenshot%202023-12-04%20at%208.42.42AM.png)

![](../../../../../../../../Assets/Pics/Screenshot%202023-12-04%20at%208.42.56AM.png)



## Ref
[👍 第九章 入侵检测 | 中传信安课程网站]: https://c4pr1c3.github.io/cuc-ns/chap0x09/main.html#95-实战入侵检测系统

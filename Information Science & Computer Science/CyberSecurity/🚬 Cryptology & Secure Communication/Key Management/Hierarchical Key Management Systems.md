# Hierarchical Key Management Systems

[TOC]



## Res


## Key Hierarchy
### 1️⃣ Primary Key/Data Encrypting Key (初级密钥，数据加密密钥)
其中，称直接用于一次通信或数据交换中的用户数据提供保护的数据加密密钥为会话密钥(Session Key);
称用于文件保密的数据加密密钥为文件密钥 (File Key)。

会话密钥一般由系统自动产生，且对用户是不可见的。一般来说，会话密钥只在会话存在期间有效，本次数据加、解密操作完成之后，会话密钥就将被立即清除，这是为了保证安全性的一种需要。会话密钥变动越频繁，通信就越安全，因为攻击者所能获知的信息越少; 另一方面，频繁改变的会话密钥将给其分发带来更多的负担;因此，作为系统安全策略的一 部分，会话密钥生命期的确定需要进行折中考虑。而初级文件密钥与其所保护的文件有一样 长的生存周期。一般要比初级会话密钥的生存周期长，有时甚至很长。


### 2️⃣ Key Encrypting Key (密钥加密密钥)
密钥加密密钥通常简称为密钥加密密钥，也称为二级密钥，它在整个密钥层次体系中位于初级密钥和主密钥之间，用于保护初级密钥。


### 3️⃣ MasterKey（主密钥）
主密钥是密钥层次体系中的最高级密钥，主密钥主要用于对密钥加密密钥进行保护。系统使用主密钥通过某种算法保护密钥加密密钥，再使用密钥加密密钥通过算法保护会话密钥，不过密钥加密密钥可能不止一个层次，最后会话密钥基于某种加、解密算法来保护 明文数据。在整个密钥层次体系中，各层密钥的使用由相应层次的密钥协议控制。

层次化的密钥结构意味着以少量高层密钥来保护大量下层密钥或明文数据，这样，可保 证除了主密钥可以以明文的形式基于严格的管理受到严密保护外(不排除受到某种变换的保 护)，其他密钥则以加密后的密文形式存储，改善了密钥的安全性。



## Benefits of Hierarchical Key Management Systems
### 安全性强
一般情况下，位于层次化密钥结构中越底层的密钥更换得越快，最底层密钥可以做到

每加密一份报文就更换一次。另外，在层次化的密钥结构中，下层的密钥被破译将不会影响到上层密钥的安全。在少量最初的处于最高层次的主密钥注入系统之后，下面各层密钥的内 容可以按照某种协议不断地变化(例如可以通过使用安全算法以及高层密钥产生低层密钥)。

对于破译者来说，层次化密钥结构意味着他所攻击的已不再是一个静止的密钥系统，而 是一个动态的密钥系统。对于一个静态的密钥系统，一份报文被破译(得到加密该报文所使 用的密钥)就可以导致使用该密钥的所有报文的泄露;而在动态的密钥系统中，密钥处在不 断的变化中，在底层密钥受到攻击后，高层密钥可以有效地保护底层密钥进行更换，从而最大限度地削弱了底层密钥被攻击所带来的影响，使得攻击者无法一劳永逸地破译密码系统，有效的保护了密钥系统整体的安全性。同时，一般来讲，直接攻击主密钥是很困难的，因为 主密钥使用的次数比较有限，并且可能会采用严密的物理保护。 


### 可实现密钥管理的自动化
由于计算机的普及应用及其飞速发展，计算机系统的信息量、计算机网络的通信量和用 户数不断增长，对密钥的需求量也随之迅速增加，人工交换密钥已经无法满足需要，而且不 能实现电子商务等网络应用中双方并不相识情况下的密钥交换，因此，必须解决密钥的自动 化管理问题。

层次化密钥结构中，除了主密钥需要由人工装入以外，其他各层的密钥均可以设计由密 钥管理系统按照某种协议进行自动地分发更换、销毁等。密钥管理自动化不仅大大提高了工 作效率，也提高了数据安全性。它可以使得核心的主密钥仅仅掌握在少数安全管理人员的范围内，这些安全管理人员不会直接接触到用户所使用的密钥(由各层密钥进行自动地协商获 得)与明文数据，而用户又不可能接触到安全管理人员所掌握的核心密钥，这样，核心密钥的扩散面达到最小，有助于保证密钥的安全性。



## Ref

